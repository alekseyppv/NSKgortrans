# NSK Gortrans Home Assistant integration

Кастомная интеграция Home Assistant для отслеживания времени прибытия нужного маршрута на остановке из страницы вида:

`https://maps.nskgortrans.ru/qr_code/qr_forecast_2.php?id=2179`

## Возможности

- Установка через **HACS** (Custom repository).
- Один URL = одна остановка (в нужном направлении, как на сайте).
- Настройка:
  - URL остановки,
  - номер маршрута (например `29` или `20а`),
  - тип транспорта (`троллейбус`, `автобус`, `маршрутное такси`, `трамвай`),
  - интервал обновления в секундах.
- Создаёт сущность `sensor` со значением минут до прибытия.
- Если маршрут не найден на странице — состояние `unknown`.

## Установка через HACS

1. Откройте **HACS → Integrations → ⋮ → Custom repositories**.
2. Добавьте URL репозитория и выберите тип **Integration**.
3. Найдите **NSK Gortrans** в HACS и установите.
4. Перезапустите Home Assistant.

## Настройка

1. Home Assistant → **Settings → Devices & Services → Add integration**.
2. Найдите `NSK Gortrans`.
3. Заполните поля:
   - **Ссылка на остановку** — полная ссылка на `qr_forecast_2.php?...`;
   - **Номер маршрута** — строка или число;
   - **Тип транспорта** — один из 4 вариантов;
   - **Интервал обновления (сек)** — от 15 до 3600.

## Результат

После настройки появляется сенсор вида:

- `sensor.trolleibus_29` (имя зависит от типа и маршрута)

Где:
- числовое значение = минут до прибытия;
- `unknown` = маршрут сейчас отсутствует на странице остановки.

## Структура

- `custom_components/nskgortrans` — интеграция Home Assistant.
- `hacs.json` — метаданные HACS.
